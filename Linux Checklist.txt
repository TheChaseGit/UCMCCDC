To view users
cat /etc/passwd
Change Passwords (good idea to write what you change the password to down)
sudo passwd username
Configure Firewall
sudo iptables -P INPUT DROP
sudo iptables -P FORWARD DROP
sudo iptables -P OUTPUT ACCEPT
To check open ports
netstat -lntp
Example for allowing specific incoming ports. Ex. allowing 3389
sudo iptables -A INPUT -p tcp --dport 3389 -j ACCEPT
To save iptables
sudo service iptables save or service iptables-persistent save
If restart is needed.
sudo service iptables restart or sudo systemctl restart iptables
If flushing initial rules is needed.
sudo iptables -F
sudo iptables -X
sudo iptables -Z
To list the rules
sudo iptables -L -n








1. Secure root
set PermitRootLogin no in /etc/ssh/sshd_config
2. Secure Users
   1. Disable the guest user.
Go to /etc/lightdm/lightdm.conf and add the line
allow-guest=false
Then restart your session with sudo restart lightdm. This will log you out, so make sure you are not executing anything important.
   2. Open up /etc/passwd and check which users
      1. Are uid 0
      2. Can login
      3. Are they allowed?
      3. Delete unauthorized users:
sudo userdel -r $user
sudo groupdel $user
      4. Check /etc/sudoers.d and make sure only members of group sudo can sudo.
      5. Check /etc/group and remove non-admins from sudo and admin groups.
      6. Check user directories.
         1. cd /home
         2. sudo ls -Ra *
         3. Look in any directories which show up for media files/tools and/or "hacking tools."
         7. Enforce Password Requirements.
Add or change password expiration requirements to /etc/login.defs.
PASS_MIN_DAYS 7
PASS_MAX_DAYS 90
PASS_WARN_AGE 14
         3. Secure sensitive files from being viewed and edited by standard users:
chmod 600 /etc/shadow
chmod 600 /etc/passwd
         4. Add a minimum password length, password history, and add complexity requirements.
         1. Open /etc/pam.d/common-password with sudo.
         2. Add minlen=8 to the end of the line that has pam_unix.so in it.
         3. Add remember=5 to the end of the line that has pam_unix.so in it.
         4. Locate the line that has pam.cracklib.so in it. If you cannot find that line, install cracklib with sudo apt-get install libpam-cracklib.
         5. Add ucredit=-1 lcredit=-1 dcredit=-1 ocredit=- to the end of that line.
         5. Implement an account lockout policy.
         1. Open /etc/pam.d/common-auth.
         2. Add deny=5 unlock_time=1800 to the end of the line with pam_tally2.so in it.
         6. Change all passwords to satisfy these requirements.
chpasswd is very useful for this purpose.


            4. Check crontabs for anything suspicious.
crontab -e
            5. Enable automatic updates
In the GUI set Update Manager->Settings->Updates->Check for updates:->Daily.
            6. Secure ports
               1. sudo ss -ln
               2. If a port has 127.0.0.1:$port in its line, that means it's connected to loopback and isn't exposed. Otherwise, there should only be ports which are specified in the readme open (but there probably will be tons more).
               3. For each open port which should be closed:
               1. sudo lsof -i :$port
               2. Copy the program which is listening on the port. whereis $program
               3. Copy where the program is (if there is more than one location, just copy the first one). dpkg -S $location
               4. This shows which package provides the file (If there is no package, that means you can probably delete it with rm $location; killall -9 $program). sudo apt-get purge $package
               5. Check to make sure you aren't accidentally removing critical packages before hitting "y".
               6. sudo ss -l to make sure the port actually closed.
               7. Secure network
               1. Enable the firewall (can skip if iptables working fine)
sudo ufw enable
               2. Enable syn cookie protection
sysctl -n net.ipv4.tcp_syncookies
               3. Disable IPv6 (Potentially harmful)
echo "net.ipv6.conf.all.disable_ipv6 = 1" | sudo tee -a /etc/sysctl.conf
               4. Disable IP Forwarding
echo 0 | sudo tee /proc/sys/net/ipv4/ip_forward
               5. Prevent IP Spoofing
echo "nospoof on" | sudo tee -a /etc/host.conf
                  8. Install Updates
Start this before half-way.
                     1. Do general updates.
                     1. sudo apt-get update.
                     2. sudo apt-get upgrade.
                     2. Update services.
                     1. Google to find what the latest stable version is.
                     2. Google "ubuntu install service version".
                     3. Follow the instructions.
                     9. Configure services
                     1. Check service configuration files for required services. Usually a wrong setting in a config file for sql, apache, etc. will be a point.


                     2. Ensure all services are legitimate.
service --status-all
                How to shutdown a service
                sudo systemctl stop ssh
                
                        10. Check the installed packages for "hacking tools," such as password crackers.